(function(){"use strict";var e={1071:function(e,t,n){var o=n(7280),i=n(3919),a=n.n(i),s=n(7154);function c(e,t){const n=(0,s.up)("router-view");return(0,s.wg)(),(0,s.j4)(n)}var r=n(7944);const l={},u=(0,r.Z)(l,[["render",c]]);var d=u,h=n(6518),p=n(6326);const m=e=>((0,s.dD)("data-v-75e3a99a"),e=e(),(0,s.Cn)(),e),g={class:"content"},w={class:"website-content"},v=m((()=>(0,s._)("h1",null,"Case Openings",-1))),f={key:1,class:"loading-wrapper"},y=m((()=>(0,s._)("div",{class:"lds-ring"},[(0,s._)("div"),(0,s._)("div"),(0,s._)("div"),(0,s._)("div")],-1))),C=[y],k={key:2,class:"inventory-container"},_=["onClick"],b={class:"inventory-count"},I=["src"];function P(e,t,n,o,i,a){const c=(0,s.up)("CaseCanvas"),r=(0,s.up)("CasePopup");return(0,s.wg)(),(0,s.iD)("div",g,[(0,s.Wm)(c),(0,s._)("div",w,[(0,s._)("header",null,[v,e.authed?((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"logout-btn",onClick:t[0]||(t[0]=(...t)=>e.signOutUser&&e.signOutUser(...t))}," Sign out ")):(0,s.kq)("",!0)]),e.authed?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",onClick:t[1]||(t[1]=(...t)=>e.googleSignIn&&e.googleSignIn(...t)),class:"login-btn"}," Login ")),!e.loaded&&e.authed?((0,s.wg)(),(0,s.iD)("div",f,C)):(0,s.kq)("",!0),e.authed&&e.loaded?((0,s.wg)(),(0,s.iD)("div",k,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.inventory,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"inventory-item",onClick:n=>e.selectCase(t)},[(0,s._)("span",b,(0,p.zw)(t.Quantity),1),(0,s._)("img",{class:"inventory-img",src:"img/"+t.ImagePath,alt:"CSGO Case Icon"},null,8,I),(0,s.Uk)(" "+(0,p.zw)(t.CaseName),1)],8,_)))),256))])):(0,s.kq)("",!0),(0,s.Wm)(r,{show:e.showPopup,onClose:e.closePopup,"weapon-case":e.selectedItem},null,8,["show","onClose","weapon-case"])])])}var O=n(329),S=n(1642),T=(0,s.aZ)({__name:"CaseCanvas",setup(e){let t,n;window.onresize=()=>{p()};const o=new O.xsS,i=new O.cPb(75,1,.1,1e3),a=new O.Ox3(new O.Ilk(16777215));let c;const r=new S.E;let l;const u=new Promise(((e,t)=>{r.load("./weapon_case.glb",(t=>{e(t.scene)}),void 0,(e=>{t(e)}))})),d=.01;function h(){requestAnimationFrame(h),l.render(o,i),c.rotation.y+=d}function p(){const e=l.domElement;t=e.clientWidth,n=e.clientHeight,e.width===t&&e.height===n||(m(),g())}function m(){l.setSize(t,n,!1),l.setPixelRatio(window.devicePixelRatio)}function g(){i.aspect=t/n,i.updateProjectionMatrix()}return(0,s.wF)((async()=>{c=await u,o.add(c),o.add(a),i.position.z=7,i.position.y=5,i.lookAt(c.position),a.position.set(i.position.x,i.position.y,i.position.z),a.lookAt(c.position),o.background=new O.Ilk("#2d3033")})),(0,s.bv)((async()=>{await u,l=new O.CP7({antialias:!0,canvas:document.getElementById("canvas")}),p(),h()})),(e,t)=>{const n=(0,s.up)("Canvas");return(0,s.wg)(),(0,s.j4)(n,{id:"canvas"})}}});const j=(0,r.Z)(T,[["__scopeId","data-v-7046757a"]]);var N=j,D=n(9786);const E={key:0,class:"modal-mask"},U={class:"modal-wrapper"},x=["src"],F={class:"button-group"},R=["src"];function z(e,t,n,i,a,c){return(0,s.wg)(),(0,s.j4)(o.uT,{name:"modal"},{default:(0,s.w5)((()=>[e.show?((0,s.wg)(),(0,s.iD)("div",E,[(0,s._)("div",U,[(0,s._)("div",{class:(0,p.C_)(["question-popup",{hide:e.confirmed}])},[(0,s._)("h1",null,"Open "+(0,p.zw)(e.caseName)+"?",1),(0,s._)("img",{src:"img/"+e.imagePath,alt:"CSGO Case Icon"},null,8,x),(0,s._)("div",F,[(0,s._)("button",{type:"button",class:"accept-btn",onClick:t[0]||(t[0]=(...t)=>e.confirm&&e.confirm(...t))}," YES "),(0,s._)("button",{type:"button",class:"close-btn",onClick:t[1]||(t[1]=(...t)=>e.closePopup&&e.closePopup(...t))}," NO ")])],2)]),(0,s._)("div",{class:(0,p.C_)(["items",{hideItems:!e.confirmed}])},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.items,((t,n)=>((0,s.wg)(),(0,s.iD)("div",{class:(0,p.C_)(["item-box",["rarity"+t.Rarity,{selected:n===e.items.length-2,hidden:!e.confirmed}]])},[(0,s._)("img",{src:"img/"+t.ImagePath,alt:"Item Picture",class:"item-picture"},null,8,R),(0,s._)("h2",null,(0,p.zw)(t.ItemName),1)],2)))),256))],2)])):(0,s.kq)("",!0)])),_:1})}n(5988);var Z=n(5767),q=(0,s.aZ)({data(){return{caseName:this.weaponCase.CaseName,imagePath:this.weaponCase.ImagePath,confirmed:!1,items:[],itemCount:30}},methods:{async removeCase(){let e=await((0,Z.v0)().currentUser?.getIdToken());if(e){let t=await fetch("/api/case",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json","CSRF-Token":this.$cookies.get("XSRF-TOKEN")},body:JSON.stringify({idToken:e,caseName:this.caseName})});return t.json()}return!1},async getItemsFromCase(){let e=await((0,Z.v0)().currentUser?.getIdToken());if(e){let t=await fetch("/api/items?"+new URLSearchParams({idToken:e,caseName:this.caseName})),n=await t.json();for(let e=0;e<this.itemCount;e++)this.items.push(n[Math.floor(Math.random()*n.length)])}},async confirm(){let e=await this.removeCase();e?(await this.getItemsFromCase(),this.confirmed=!0,setTimeout((()=>{this.closePopup()}),8e3)):this.closePopup()},closePopup(){this.confirmed=!1,this.$emit("close")}},watch:{show(e,t){this.caseName=this.weaponCase.CaseName,this.imagePath=this.weaponCase.ImagePath,this.confirmed=!1}},props:["show","weaponCase"]});const A=(0,r.Z)(q,[["render",z],["__scopeId","data-v-d5785966"]]);var W=A,B=(0,s.aZ)({name:"HomeView",data(){return{authed:!1,admin:!1,inventory:[],showPopup:!1,selectedItem:{},loaded:!1}},methods:{closePopup(){this.getInventory(),this.showPopup=!1},async loginUserWithBackend(){const e=(0,D.v0)().currentUser;if(e){this.authed=!0;const t=await e.getIdToken(),n=await fetch("/api/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","CSRF-Token":this.$cookies.get("XSRF-TOKEN")},body:JSON.stringify({idToken:t})});if(n.ok){const e=await n.json();this.admin=e,this.getInventory().then((()=>{this.loaded=!0}))}else 401===n.status&&(this.authed=!1,this.admin=!1,this.loaded=!1)}else this.authed=!1,this.admin=!1,this.loaded=!1},googleSignIn(){(0,D.rh)((0,D.v0)(),new D.hJ).then((e=>{this.loginUserWithBackend()})).catch((e=>{console.log("Error Signing in with Google "+e)}))},signOutUser(){(0,D.w7)((0,D.v0)()).then((()=>{this.authed=!1,this.admin=!1,this.loaded=!1}))},async getInventory(){let e=await((0,D.v0)().currentUser?.getIdToken())||"";fetch("/api/inventory?"+new URLSearchParams({idToken:e})).then((async e=>{e.ok?(this.inventory=await e.json(),console.log(this.inventory),this.$refs.inventoryItem.updateValues()):console.log(e)})).catch((e=>{console.log(e)}))},selectCase(e){this.showPopup=!0,this.selectedItem=e,console.log(this.selectedItem)}},mounted(){fetch("/api/csrf"),this.loginUserWithBackend()},components:{CaseCanvas:N,CasePopup:W}});const K=(0,r.Z)(B,[["render",P],["__scopeId","data-v-75e3a99a"]]);var L=K;const M=[{path:"/",name:"home",component:L}],$=(0,h.p7)({history:(0,h.PO)("/main/"),routes:M});var H=$,G=n(7744);const J={apiKey:"AIzaSyA6ETL9QMZR7VeNodRdc1q5X662iDz8CaE",authDomain:"case-openings.firebaseapp.com",projectId:"case-openings",storageBucket:"case-openings.appspot.com",messagingSenderId:"502306099010",appId:"1:502306099010:web:a96054b3f179d4ef0742db"};(0,G.ZF)(J);(0,Z.Fb)((0,Z.v0)(),Z.a$),(0,o.ri)(d).use(H).use(a()).mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,a){if(!o){var s=1/0;for(u=0;u<e.length;u++){o=e[u][0],i=e[u][1],a=e[u][2];for(var c=!0,r=0;r<o.length;r++)(!1&a||s>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[r])}))?o.splice(r--,1):(c=!1,a<s&&(s=a));if(c){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[o,i,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,a,s=o[0],c=o[1],r=o[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(i in c)n.o(c,i)&&(n.m[i]=c[i]);if(r)var u=r(n)}for(t&&t(o);l<s.length;l++)a=s[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},o=self["webpackChunk_case_opening_frontend"]=self["webpackChunk_case_opening_frontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(1071)}));o=n.O(o)})();
//# sourceMappingURL=app.68a93778.js.map