(function(){"use strict";var e={3299:function(e,t,n){var o=n(7280),i=n(3919),s=n.n(i),a=n(7154);function c(e,t){const n=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(n)}var r=n(7944);const u={},l=(0,r.Z)(u,[["render",c]]);var p=l,h=n(6518),d=n(6326);const m=e=>((0,a.dD)("data-v-344193c3"),e=e(),(0,a.Cn)(),e),g={class:"content"},w={class:"website-content"},f=m((()=>(0,a._)("h1",null,"Case Openings",-1))),v={key:1,class:"inventory-container"},y=["onClick"],C={class:"inventory-count"},k=["src"];function b(e,t,n,o,i,s){const c=(0,a.up)("CaseCanvas"),r=(0,a.up)("CasePopup");return(0,a.wg)(),(0,a.iD)("div",g,[(0,a.Wm)(c),(0,a._)("div",w,[(0,a._)("header",null,[f,e.authed?((0,a.wg)(),(0,a.iD)("button",{key:0,type:"button",class:"logout-btn",onClick:t[0]||(t[0]=(...t)=>e.signOutUser&&e.signOutUser(...t))}," Sign out ")):(0,a.kq)("",!0)]),e.authed?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("button",{key:0,type:"button",onClick:t[1]||(t[1]=(...t)=>e.googleSignIn&&e.googleSignIn(...t)),class:"login-btn"}," Login ")),e.authed?((0,a.wg)(),(0,a.iD)("div",v,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.inventory,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"inventory-item",onClick:n=>e.selectCase(t)},[(0,a._)("span",C,(0,d.zw)(t.Quantity),1),(0,a._)("img",{class:"inventory-img",src:"img/"+t.ImagePath,alt:"CSGO Case Icon"},null,8,k),(0,a.Uk)(" "+(0,d.zw)(t.CaseName),1)],8,y)))),256))])):(0,a.kq)("",!0),(0,a.Wm)(r,{show:e.showPopup,onClose:e.closePopup,"weapon-case":e.selectedItem},null,8,["show","onClose","weapon-case"])])])}var I=n(329),_=n(1642),P=(0,a.aZ)({__name:"CaseCanvas",setup(e){let t,n;window.onresize=()=>{d()};const o=new I.xsS,i=new I.cPb(75,1,.1,1e3),s=new I.Ox3(new I.Ilk(16777215));let c;const r=new _.E;let u;const l=new Promise(((e,t)=>{r.load("./weapon_case.glb",(t=>{e(t.scene)}),void 0,(e=>{t(e)}))})),p=.01;function h(){requestAnimationFrame(h),u.render(o,i),c.rotation.y+=p}function d(){const e=u.domElement;t=e.clientWidth,n=e.clientHeight,e.width===t&&e.height===n||(m(),g())}function m(){u.setSize(t,n,!1),u.setPixelRatio(window.devicePixelRatio)}function g(){i.aspect=t/n,i.updateProjectionMatrix()}return(0,a.wF)((async()=>{c=await l,o.add(c),o.add(s),i.position.z=7,i.position.y=5,i.lookAt(c.position),s.position.set(i.position.x,i.position.y,i.position.z),s.lookAt(c.position),o.background=new I.Ilk("#2d3033")})),(0,a.bv)((async()=>{await l,u=new I.CP7({antialias:!0,canvas:document.getElementById("canvas")}),d(),h()})),(e,t)=>{const n=(0,a.up)("Canvas");return(0,a.wg)(),(0,a.j4)(n,{id:"canvas"})}}});const O=(0,r.Z)(P,[["__scopeId","data-v-7046757a"]]);var S=O,T=n(9786);const j={key:0,class:"modal-mask"},N={class:"modal-wrapper"},D=["src"],E={class:"button-group"},U=["src"];function x(e,t,n,i,s,c){return(0,a.wg)(),(0,a.j4)(o.uT,{name:"modal"},{default:(0,a.w5)((()=>[e.show?((0,a.wg)(),(0,a.iD)("div",j,[(0,a._)("div",N,[(0,a._)("div",{class:(0,d.C_)(["question-popup",{hide:e.confirmed}])},[(0,a._)("h1",null,"Open "+(0,d.zw)(e.caseName)+"?",1),(0,a._)("img",{src:"img/"+e.imagePath,alt:"CSGO Case Icon"},null,8,D),(0,a._)("div",E,[(0,a._)("button",{type:"button",class:"accept-btn",onClick:t[0]||(t[0]=(...t)=>e.confirm&&e.confirm(...t))}," YES "),(0,a._)("button",{type:"button",class:"close-btn",onClick:t[1]||(t[1]=(...t)=>e.closePopup&&e.closePopup(...t))}," NO ")])],2)]),(0,a._)("div",{class:(0,d.C_)(["items",{hideItems:!e.confirmed}])},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.items,((t,n)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,d.C_)(["item-box",["rarity"+t.Rarity,{selected:n===e.items.length-2,hidden:!e.confirmed}]])},[(0,a._)("img",{src:"img/"+t.ImagePath,alt:"Item Picture",class:"item-picture"},null,8,U),(0,a._)("h2",null,(0,d.zw)(t.ItemName),1)],2)))),256))],2)])):(0,a.kq)("",!0)])),_:1})}n(5988);var F=n(5767),R=(0,a.aZ)({data(){return{caseName:this.weaponCase.CaseName,imagePath:this.weaponCase.ImagePath,confirmed:!1,items:[],itemCount:30}},methods:{async removeCase(){let e=await((0,F.v0)().currentUser?.getIdToken());if(e){let t=await fetch("/api/case",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json","CSRF-Token":this.$cookies.get("XSRF-TOKEN")},body:JSON.stringify({idToken:e,caseName:this.caseName})});return t.json()}return!1},async getItemsFromCase(){let e=await((0,F.v0)().currentUser?.getIdToken());if(e){let t=await fetch("/api/items?"+new URLSearchParams({idToken:e,caseName:this.caseName})),n=await t.json();for(let e=0;e<this.itemCount;e++)this.items.push(n[Math.floor(Math.random()*n.length)])}},async confirm(){let e=await this.removeCase();e?(await this.getItemsFromCase(),this.confirmed=!0,setTimeout((()=>{this.closePopup()}),8e3)):this.closePopup()},closePopup(){this.confirmed=!1,this.$emit("close")}},watch:{show(e,t){this.caseName=this.weaponCase.CaseName,this.imagePath=this.weaponCase.ImagePath,this.confirmed=!1}},props:["show","weaponCase"]});const z=(0,r.Z)(R,[["render",x],["__scopeId","data-v-d5785966"]]);var Z=z,q=(0,a.aZ)({name:"HomeView",data(){return{authed:!1,admin:!1,inventory:[],showPopup:!1,selectedItem:{}}},methods:{closePopup(){this.getInventory(),this.showPopup=!1},async loginUserWithBackend(){const e=(0,T.v0)().currentUser;if(e){const t=await e.getIdToken(),n=await fetch("/api/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","CSRF-Token":this.$cookies.get("XSRF-TOKEN")},body:JSON.stringify({idToken:t})});if(n.ok){const e=await n.json();await this.getInventory(),this.authed=!0,this.admin=e}else 401===n.status&&(this.authed=!1,this.admin=!1)}else this.authed=!1,this.admin=!1},googleSignIn(){(0,T.rh)((0,T.v0)(),new T.hJ).then((async e=>{await this.loginUserWithBackend()})).catch((e=>{console.log("Error Signing in with Google "+e)}))},signOutUser(){(0,T.w7)((0,T.v0)()).then((()=>{this.authed=!1}))},async getInventory(){let e=await((0,T.v0)().currentUser?.getIdToken())||"";fetch("/api/inventory?"+new URLSearchParams({idToken:e})).then((async e=>{e.ok?(this.inventory=await e.json(),console.log(this.inventory),this.$refs.inventoryItem.updateValues()):console.log(e)})).catch((e=>{console.log(e)}))},selectCase(e){this.showPopup=!0,this.selectedItem=e,console.log(this.selectedItem)}},mounted(){fetch("/api/csrf"),this.loginUserWithBackend()},components:{CaseCanvas:S,CasePopup:Z}});const A=(0,r.Z)(q,[["render",b],["__scopeId","data-v-344193c3"]]);var W=A;const B=[{path:"/",name:"home",component:W}],K=(0,h.p7)({history:(0,h.PO)("/main/"),routes:B});var L=K,M=n(7744);const $={apiKey:"AIzaSyA6ETL9QMZR7VeNodRdc1q5X662iDz8CaE",authDomain:"case-openings.firebaseapp.com",projectId:"case-openings",storageBucket:"case-openings.appspot.com",messagingSenderId:"502306099010",appId:"1:502306099010:web:a96054b3f179d4ef0742db"};(0,M.ZF)($);(0,F.Fb)((0,F.v0)(),F.a$),(0,o.ri)(p).use(L).use(s()).mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,s){if(!o){var a=1/0;for(l=0;l<e.length;l++){o=e[l][0],i=e[l][1],s=e[l][2];for(var c=!0,r=0;r<o.length;r++)(!1&s||a>=s)&&Object.keys(n.O).every((function(e){return n.O[e](o[r])}))?o.splice(r--,1):(c=!1,s<a&&(a=s));if(c){e.splice(l--,1);var u=i();void 0!==u&&(t=u)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[o,i,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,s,a=o[0],c=o[1],r=o[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(i in c)n.o(c,i)&&(n.m[i]=c[i]);if(r)var l=r(n)}for(t&&t(o);u<a.length;u++)s=a[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(l)},o=self["webpackChunk_case_opening_frontend"]=self["webpackChunk_case_opening_frontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(3299)}));o=n.O(o)})();
//# sourceMappingURL=app.bcb2ebf7.js.map